<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ModalServiceFluent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Ring of Automation UI Test Framework</a> &gt; <a href="index.source.html" class="el_package">io.cyborgcode.roa.ui.service.fluent</a> &gt; <span class="el_source">ModalServiceFluent.java</span></div><h1>ModalServiceFluent.java</h1><pre class="source lang-java linenums">package io.cyborgcode.roa.ui.service.fluent;

import io.cyborgcode.roa.framework.storage.Storage;
import io.cyborgcode.roa.ui.components.modal.ModalService;
import io.cyborgcode.roa.ui.selenium.ModalUiElement;
import io.cyborgcode.roa.ui.selenium.smart.SmartWebDriver;
import io.qameta.allure.Allure;
import org.assertj.core.api.Assertions;

import static io.cyborgcode.roa.ui.storage.StorageKeysUi.UI;

/**
 * A fluent service class for interacting with modal UI elements in test automation.
 *
 * &lt;p&gt;Provides methods for clicking buttons within modals, retrieving modal details, and closing modals.
 *
 * &lt;p&gt;The generic type {@code T} represents the UI service fluent implementation that extends {@link UiServiceFluent},
 * allowing method chaining for seamless interaction.
 *
 * @author Cyborg Code Syndicate üíçüë®üíª
 */
@SuppressWarnings({&quot;java:S5960&quot;, &quot;unchecked&quot;})
public class ModalServiceFluent&lt;T extends UiServiceFluent&lt;?&gt;&gt; {

   private static final String VALIDATING_MODAL = &quot;Validating Modal&quot;;
   private final ModalService modalService;
   private final T uiServiceFluent;
   private final Storage storage;
   private final SmartWebDriver driver;

   /**
    * Constructs a new {@code ModalServiceFluent} instance.
    *
    * @param uiServiceFluent The parent fluent UI service instance.
    * @param storage         The storage instance for storing validation results.
    * @param modalService    The modal service responsible for interacting with modals.
    * @param webDriver       The smart web driver used for interactions.
    */
   public ModalServiceFluent(T uiServiceFluent, Storage storage, ModalService modalService,
<span class="fc" id="L40">                             SmartWebDriver webDriver) {</span>
<span class="fc" id="L41">      this.modalService = modalService;</span>
<span class="fc" id="L42">      this.uiServiceFluent = uiServiceFluent;</span>
<span class="fc" id="L43">      this.storage = storage;</span>
<span class="fc" id="L44">      this.driver = webDriver;</span>
<span class="fc" id="L45">   }</span>

   /**
    * Checks whether the specified modal UI element is currently opened.
    *
    * @param element The {@link ModalUiElement} representing the modal to be checked.
    * @return The fluent UI service instance.
    */
   public T isOpened(final ModalUiElement element) {
<span class="fc" id="L54">      Allure.step(&quot;[UI - Modal] Check if modal is opened&quot;);</span>

<span class="fc" id="L56">      element.before().accept(driver);</span>
<span class="fc" id="L57">      boolean isOpened = modalService.isOpened(element.componentType());</span>
<span class="fc" id="L58">      element.after().accept(driver);</span>
<span class="fc" id="L59">      storage.sub(UI).put(element.enumImpl(), isOpened);</span>
<span class="fc" id="L60">      return uiServiceFluent;</span>
   }

   /**
    * Validates that the specified modal UI element is opened.
    *
    * @param element The {@link ModalUiElement} representing the modal to validate.
    * @return The fluent UI service instance.
    */
   public T validateIsOpened(final ModalUiElement element) {
<span class="fc" id="L70">      return validateIsOpened(element, true, false);</span>
   }

   /**
    * Validates that the specified modal UI element is opened, with the option to perform soft assertion.
    *
    * @param element The {@link ModalUiElement} representing the modal to validate.
    * @param soft    If true, performs a soft assertion; otherwise, performs a hard assertion.
    * @return The fluent UI service instance.
    */
   public T validateIsOpened(final ModalUiElement element, boolean soft) {
<span class="fc" id="L81">      return validateIsOpened(element, true, soft);</span>
   }

   private T validateIsOpened(final ModalUiElement element, boolean shouldBeOpened, boolean soft) {
<span class="fc" id="L85">      Allure.step(String.format(&quot;[UI - Modal] Checking if modal with component type: %s is opened&quot;,</span>
<span class="fc" id="L86">            element.componentType()));</span>

<span class="fc" id="L88">      element.before().accept(driver);</span>
<span class="fc" id="L89">      boolean isOpened = modalService.isOpened(element.componentType());</span>
<span class="fc" id="L90">      element.after().accept(driver);</span>
<span class="fc" id="L91">      storage.sub(UI).put(element.enumImpl(), isOpened);</span>

<span class="fc bfc" id="L93" title="All 2 branches covered.">      String assertionMessage = shouldBeOpened</span>
<span class="fc" id="L94">            ? &quot;Validating Modal is opened&quot;</span>
<span class="fc" id="L95">            : &quot;Validating Modal is closed&quot;;</span>

<span class="fc bfc" id="L97" title="All 2 branches covered.">      if (soft) {</span>
<span class="fc" id="L98">         return (T) uiServiceFluent.validate(</span>
               softAssertions -&gt; {
<span class="fc bfc" id="L100" title="All 2 branches covered.">                  if (shouldBeOpened) {</span>
<span class="fc" id="L101">                     softAssertions.assertThat(isOpened).as(assertionMessage).isTrue();</span>
                  } else {
<span class="fc" id="L103">                     softAssertions.assertThat(isOpened).as(assertionMessage).isFalse();</span>
                  }
<span class="fc" id="L105">               }</span>
         );
      } else {
<span class="fc" id="L108">         return (T) uiServiceFluent.validate(</span>
               () -&gt; {
<span class="fc bfc" id="L110" title="All 2 branches covered.">                  if (shouldBeOpened) {</span>
<span class="fc" id="L111">                     Assertions.assertThat(isOpened).as(assertionMessage).isTrue();</span>
                  } else {
<span class="fc" id="L113">                     Assertions.assertThat(isOpened).as(assertionMessage).isFalse();</span>
                  }
<span class="fc" id="L115">               }</span>
         );
      }
   }

   /**
    * Validates that the specified modal UI element is closed.
    *
    * @param element The {@link ModalUiElement} representing the modal to validate.
    * @return The fluent UI service instance.
    */
   public T validateIsClosed(final ModalUiElement element) {
<span class="fc" id="L127">      return validateIsOpened(element, false, false);</span>
   }

   /**
    * Validates that the specified modal UI element is closed, with the option to perform soft assertion.
    *
    * @param element The {@link ModalUiElement} representing the modal to validate.
    * @param soft    If true, performs a soft assertion; otherwise, performs a hard assertion.
    * @return The fluent UI service instance.
    */
   public T validateIsClosed(final ModalUiElement element, boolean soft) {
<span class="fc" id="L138">      return validateIsOpened(element, false, soft);</span>
   }

   /**
    * Clicks a button inside the specified modal UI element.
    *
    * @param element The {@link ModalUiElement} representing the modal UI component.
    * @return The fluent UI service instance.
    */
   public T click(final ModalUiElement element) {
<span class="fc" id="L148">      Allure.step(&quot;[UI - Modal] Click button inside the modal UI element&quot;);</span>

<span class="fc" id="L150">      element.before().accept(driver);</span>
<span class="fc" id="L151">      modalService.clickButton(element.componentType(), element.locator());</span>
<span class="fc" id="L152">      element.after().accept(driver);</span>
<span class="fc" id="L153">      return uiServiceFluent;</span>
   }

   /**
    * Retrieves the title of the specified modal UI element.
    *
    * @param element The {@link ModalUiElement} representing the modal.
    * @return The fluent UI service instance.
    */
   public T getTitle(final ModalUiElement element) {
<span class="fc" id="L163">      Allure.step(&quot;[UI - Modal] Retrieve title of the modal UI element&quot;);</span>

<span class="fc" id="L165">      element.before().accept(driver);</span>
<span class="fc" id="L166">      String modalTitle = modalService.getTitle(element.componentType());</span>
<span class="fc" id="L167">      element.after().accept(driver);</span>
<span class="fc" id="L168">      storage.sub(UI).put(element.enumImpl(), modalTitle);</span>
<span class="fc" id="L169">      return uiServiceFluent;</span>
   }

   /**
    * Validates the title of the specified modal UI element matches the expected value.
    *
    * @param element       The {@link ModalUiElement} representing the modal.
    * @param expectedValue The expected title value.
    * @return The fluent UI service instance.
    */
   public T validateTitle(final ModalUiElement element, final String expectedValue) {
<span class="fc" id="L180">      Allure.step(&quot;[UI - Modal] Validate title of the modal&quot;);</span>
<span class="fc" id="L181">      return validateTitle(element, false, expectedValue);</span>
   }

   /**
    * Validates the title of the specified modal UI element matches the expected value,
    * with an option for soft assertion.
    *
    * @param element       The {@link ModalUiElement} representing the modal.
    * @param soft          If true, performs a soft assertion; otherwise, performs a hard assertion.
    * @param expectedValue The expected title value.
    * @return The fluent UI service instance.
    */
   public T validateTitle(final ModalUiElement element, boolean soft, final String expectedValue) {
<span class="fc" id="L194">      Allure.step(&quot;[UI - Modal] Validate title of the modal&quot;);</span>
<span class="fc" id="L195">      element.before().accept(driver);</span>
<span class="fc" id="L196">      String modalTitle = modalService.getTitle(element.componentType());</span>
<span class="fc" id="L197">      element.after().accept(driver);</span>
<span class="fc" id="L198">      storage.sub(UI).put(element.enumImpl(), modalTitle);</span>

<span class="fc bfc" id="L200" title="All 2 branches covered.">      if (soft) {</span>
<span class="fc" id="L201">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L202">               softAssertions -&gt; softAssertions.assertThat(modalTitle)</span>
<span class="fc" id="L203">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L204">                     .isEqualTo(expectedValue)</span>
         );
      } else {
<span class="fc" id="L207">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L208">               () -&gt; Assertions.assertThat(modalTitle)</span>
<span class="fc" id="L209">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L210">                     .isEqualTo(expectedValue)</span>
         );
      }
   }

   /**
    * Retrieves the content title of the specified modal UI element.
    *
    * @param element The {@link ModalUiElement} representing the modal.
    * @return The fluent UI service instance.
    */
   public T getContentTitle(final ModalUiElement element) {
<span class="fc" id="L222">      Allure.step(&quot;[UI - Modal] Retrieve content title of the modal UI element&quot;);</span>

<span class="fc" id="L224">      element.before().accept(driver);</span>
<span class="fc" id="L225">      String modalContentTitle = modalService.getContentTitle(element.componentType());</span>
<span class="fc" id="L226">      element.after().accept(driver);</span>
<span class="fc" id="L227">      storage.sub(UI).put(element.enumImpl(), modalContentTitle);</span>
<span class="fc" id="L228">      return uiServiceFluent;</span>
   }

   /**
    * Validates the content title of the specified modal UI element matches the expected value.
    *
    * @param element       The {@link ModalUiElement} representing the modal.
    * @param expectedValue The expected content title.
    * @return The fluent UI service instance.
    */
   public T validateContentTitle(final ModalUiElement element, final String expectedValue) {
<span class="fc" id="L239">      Allure.step(&quot;[UI - Modal] Validate content title of the modal&quot;);</span>
<span class="fc" id="L240">      return validateContentTitle(element, false, expectedValue);</span>
   }

   /**
    * Validates the content title of the specified modal UI element matches the expected value,
    * with an option for soft assertion.
    *
    * @param element       The {@link ModalUiElement} representing the modal.
    * @param soft          If true, performs a soft assertion; otherwise, performs a hard assertion.
    * @param expectedValue The expected content title.
    * @return The fluent UI service instance.
    */
   public T validateContentTitle(final ModalUiElement element, boolean soft, final String expectedValue) {
<span class="fc" id="L253">      Allure.step(&quot;[UI - Modal] Validate content title of the modal&quot;);</span>
<span class="fc" id="L254">      element.before().accept(driver);</span>
<span class="fc" id="L255">      String modalContentTitle = modalService.getContentTitle(element.componentType());</span>
<span class="fc" id="L256">      element.after().accept(driver);</span>
<span class="fc" id="L257">      storage.sub(UI).put(element.enumImpl(), modalContentTitle);</span>

<span class="fc bfc" id="L259" title="All 2 branches covered.">      if (soft) {</span>
<span class="fc" id="L260">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L261">               softAssertions -&gt; softAssertions.assertThat(modalContentTitle)</span>
<span class="fc" id="L262">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L263">                     .isEqualTo(expectedValue)</span>
         );
      } else {
<span class="fc" id="L266">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L267">               () -&gt; Assertions.assertThat(modalContentTitle)</span>
<span class="fc" id="L268">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L269">                     .isEqualTo(expectedValue)</span>
         );
      }
   }

   /**
    * Retrieves the body text of the specified modal UI element.
    *
    * @param element The {@link ModalUiElement} representing the modal.
    * @return The fluent UI service instance.
    */
   public T getBodyText(final ModalUiElement element) {
<span class="fc" id="L281">      Allure.step(&quot;[UI - Modal] Retrieve body text of the modal UI element&quot;);</span>

<span class="fc" id="L283">      element.before().accept(driver);</span>
<span class="fc" id="L284">      String modalBodyText = modalService.getBodyText(element.componentType());</span>
<span class="fc" id="L285">      element.after().accept(driver);</span>
<span class="fc" id="L286">      storage.sub(UI).put(element.enumImpl(), modalBodyText);</span>
<span class="fc" id="L287">      return uiServiceFluent;</span>
   }

   /**
    * Validates the content of the specified modal UI element matches the expected value.
    *
    * @param element      The {@link ModalUiElement} representing the modal.
    * @param expectedText The expected content.
    * @return The fluent UI service instance.
    */
   public T validateBodyText(final ModalUiElement element, final String expectedText) {
<span class="fc" id="L298">      Allure.step(&quot;[UI - Modal] Validate content of the modal&quot;);</span>
<span class="fc" id="L299">      return validateBodyText(element, false, expectedText);</span>
   }

   /**
    * Validates the content of the specified modal UI element matches the expected value,
    * with an option for soft assertion.
    *
    * @param element       The {@link ModalUiElement} representing the modal.
    * @param soft          If true, performs a soft assertion; otherwise, performs a hard assertion.
    * @param expectedValue The expected content value.
    * @return The fluent UI service instance.
    */
   public T validateBodyText(final ModalUiElement element, boolean soft, final String expectedValue) {
<span class="fc" id="L312">      Allure.step(&quot;[UI - Modal] Validate content of the modal&quot;);</span>
<span class="fc" id="L313">      element.before().accept(driver);</span>
<span class="fc" id="L314">      String modalBodyText = modalService.getBodyText(element.componentType());</span>
<span class="fc" id="L315">      element.after().accept(driver);</span>
<span class="fc" id="L316">      storage.sub(UI).put(element.enumImpl(), modalBodyText);</span>

<span class="fc bfc" id="L318" title="All 2 branches covered.">      if (soft) {</span>
<span class="fc" id="L319">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L320">               softAssertions -&gt; softAssertions.assertThat(modalBodyText)</span>
<span class="fc" id="L321">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L322">                     .isEqualTo(expectedValue)</span>
         );
      } else {
<span class="fc" id="L325">         return (T) uiServiceFluent.validate(</span>
<span class="fc" id="L326">               () -&gt; Assertions.assertThat(modalBodyText)</span>
<span class="fc" id="L327">                     .as(VALIDATING_MODAL)</span>
<span class="fc" id="L328">                     .isEqualTo(expectedValue)</span>
         );
      }
   }

   /**
    * Closes the specified modal UI element.
    *
    * @param element The {@link ModalUiElement} representing the modal.
    * @return The fluent UI service instance.
    */
   public T close(final ModalUiElement element) {
<span class="fc" id="L340">      Allure.step(&quot;[UI - Modal] Close the modal UI element&quot;);</span>

<span class="fc" id="L342">      element.before().accept(driver);</span>
<span class="fc" id="L343">      modalService.close(element.componentType());</span>
<span class="fc" id="L344">      element.after().accept(driver);</span>
<span class="fc" id="L345">      return uiServiceFluent;</span>
   }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>