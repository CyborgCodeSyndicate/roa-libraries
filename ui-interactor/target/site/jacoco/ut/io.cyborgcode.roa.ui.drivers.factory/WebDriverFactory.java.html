<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WebDriverFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Ring of Automation UI Library</a> &gt; <a href="index.source.html" class="el_package">io.cyborgcode.roa.ui.drivers.factory</a> &gt; <span class="el_source">WebDriverFactory.java</span></div><h1>WebDriverFactory.java</h1><pre class="source lang-java linenums">package io.cyborgcode.roa.ui.drivers.factory;

import io.cyborgcode.roa.ui.drivers.base.DriverProvider;
import io.cyborgcode.roa.ui.drivers.config.WebDriverConfig;
import io.cyborgcode.roa.ui.drivers.providers.ChromeDriverProvider;
import io.cyborgcode.roa.ui.drivers.providers.EdgeDriverProvider;
import java.util.Map;
import java.util.Optional;
import java.util.concurrent.ConcurrentHashMap;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebDriverException;
import org.openqa.selenium.remote.AbstractDriverOptions;

/**
 * Factory class for creating WebDriver instances based on registered driver providers.
 *
 * &lt;p&gt;This class manages WebDriver providers for different browser types and facilitates the
 * creation of WebDriver instances with appropriate configurations.
 *
 * &lt;p&gt;By default, Chrome and Edge drivers are registered. Additional drivers can be registered
 * dynamically using the {@link #registerDriver(String, DriverProvider)} method.
 *
 * @author Cyborg Code Syndicate üíçüë®üíª
 */
public class WebDriverFactory {

   private WebDriverFactory() {
   }

   /**
    * Stores registered WebDriver providers, mapped by browser type (e.g., &quot;CHROME&quot;, &quot;EDGE&quot;).
    */
<span class="fc" id="L33">   private static final Map&lt;String, DriverProvider&lt;?&gt;&gt; DRIVER_PROVIDERS = new ConcurrentHashMap&lt;&gt;();</span>

   static {
<span class="fc" id="L36">      registerDriver(&quot;CHROME&quot;, new ChromeDriverProvider());</span>
<span class="fc" id="L37">      registerDriver(&quot;EDGE&quot;, new EdgeDriverProvider());</span>
<span class="fc" id="L38">   }</span>

   /**
    * Registers a new WebDriver provider for a specified browser type.
    *
    * @param type     The browser type (e.g., &quot;CHROME&quot;, &quot;EDGE&quot;).
    * @param provider The driver provider responsible for creating and managing the WebDriver instance.
    * @param &lt;T&gt;      The type parameter extending {@link DriverProvider}.
    * @throws IllegalArgumentException If a driver for the specified type is already registered.
    */
   public static &lt;T extends DriverProvider&lt;?&gt;&gt; void registerDriver(String type, T provider) {
<span class="fc bfc" id="L49" title="All 2 branches covered.">      if (DRIVER_PROVIDERS.containsKey(type.trim().toUpperCase())) {</span>
<span class="fc" id="L50">         throw new IllegalArgumentException(&quot;Driver type already registered: &quot; + type);</span>
      }
<span class="fc" id="L52">      DRIVER_PROVIDERS.put(type.trim().toUpperCase(), provider);</span>
<span class="fc" id="L53">   }</span>

   /**
    * Creates a WebDriver instance for the specified browser type, using the provided configuration.
    *
    * @param type   The browser type (e.g., &quot;CHROME&quot;, &quot;EDGE&quot;).
    * @param config The WebDriver configuration, specifying options such as version and headless mode.
    * @return A fully configured {@link WebDriver} instance.
    * @throws IllegalArgumentException If no driver is registered for the specified type.
    * @throws RuntimeException         If WebDriver creation fails due to an unexpected error.
    */
   @SuppressWarnings({&quot;rawtypes&quot;, &quot;unchecked&quot;}) // Necessary for generic factory call
   public static WebDriver createDriver(String type, WebDriverConfig config) {
<span class="fc" id="L66">      DriverProvider&lt;?&gt; provider = Optional.ofNullable(DRIVER_PROVIDERS.get(type.trim().toUpperCase()))</span>
<span class="fc" id="L67">            .orElseThrow(() -&gt; new IllegalArgumentException(&quot;No driver registered for type: &quot; + type));</span>

<span class="fc" id="L69">      provider.setupDriver(config.getVersion());</span>

      try {
<span class="fc" id="L72">         return new DriverCreator&lt;&gt;().createDriver(config,</span>
               (DriverProvider&lt;AbstractDriverOptions&lt;?&gt;&gt;) provider);
<span class="fc" id="L74">      } catch (Exception e) {</span>
<span class="fc" id="L75">         throw new WebDriverException(&quot;Failed to create WebDriver for type: &quot; + type, e);</span>
      }
   }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>